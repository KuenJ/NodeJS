<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
     <link rel="stylesheet" href="/main.css">
</head>
<body class="grey-bg">

    <%- include('nav.ejs') %>   
<div class="white-bg">


   <% for(let i =0 ; i < title.length ;i++){ %>
       <div class="list-box">
          <!--  <%= JSON.stringify(title[i]._id) %>  JSON.stringify()ëŠ” JavaScript ê°ì²´ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. J-->
    <h4>
      <a href="/detail/<%= title[i]._id %>">
      <%= title[i].title %>
       </a>
       <a href="/edit/<%= title[i]._id %>">âœï¸</a> <!--ë’¤ì—ëŠ” ê¸€ì—í•´ë‹¹í•˜ëŠ” idë¥¼ì§ì ‘ë„£ì–´ì¤˜ì„œ í•´ë‹¹í•˜ëŠ” id ì—ë§ê²Œ ìš”ì²­í˜ì´ì§€ ì ‘ì†ê°€ëŠ¥í•˜ê²Œí•œê²ƒì´ë‹¤ .-->
       <span class="delete" data-id="<%= title[i]._id %>" >ğŸ—‘ï¸</span>  <!-- data-idë¡œ í•´ì„œ  functionì—(e) ë¡œë§¤ê°œë³€ìˆ˜ì¤€ë’¤ ê°’ë“¤ì„ e.target.dataset.idë¡œ ë„£ì–´ì£¼ë©´ idì •ë³´ê°’ì´ë³´ë‚´ì§„ë‹¤ .-->
   
    <p><%= title[i].content %></p>
 
  </div>
    <%} %>
<!--foreachë¡œ    forë¬¸ì„ ëŒ€ì‹ í•˜ë©´ì¢€ë”ì¢‹ì„ê²ƒê°™ë‹¤ 

  <% title.forEach(function(item) { %>
    <div class="list-box">
        <h4>
            <a href="/detail/<%= item._id %>">
                <%= item.title %>
            </a>
            <a href="/edit/<%= item._id %>">âœï¸</a>
            <span class="delete" data-id="<%= item._id %>" >ğŸ—‘ï¸</span>
        </h4>
        <p><%= item.content %></p>
    </div>
<% }); %>

  
  
  .-->



 
  </div>
</div> 
  
</div> 

<script>
  // console.log('<%= title[0]._id %>')

 
  // NodeListë¥¼ ë°°ì—´ë¡œ ë³€í™˜í•˜ì—¬ ê° ìš”ì†Œì— ëŒ€í•´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
  // document.querySelectorAll('.delete').forEach(function(element) {  //document.querySelactorAllì„ ì‚¬ìš©í•˜ë©´ ì„ íƒí•œ ëª¨ë“ ìš”ì†Œì—ëŒ€í•œëª©ë¡ì„ ë°˜í™˜í•˜ë¯€ë¡œ forEachë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ìš”ì†Œì—ëŒ€í•œì‘ì—…ìˆ˜í–‰ê°€ëŠ¥ 
  //   element.addEventListener('click', function(e) {
  //     fetch('/delete?docid=' + e.target.dataset.id, {
  //       method: 'DELETE'
  //     });
  //   });
  // });

  for (let i = 0; i <'<%= title.length%>'; i++) {
    document.querySelectorAll('.delete')[i]
      .addEventListener('click', function(e) {
        fetch('/delete?docid=' + e.target.dataset.id, {
          method: 'DELETE'
        })
        .then((r)=>r.text())
        .then((r)=>{console.log(r)})
      })
  }

</script>


</script>

</body>
</html>